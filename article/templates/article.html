{% extends 'base.html' %}
{% block meta %}
{% load static %}
<title>Article do-nasi</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
<link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js"></script>
<link rel="stylesheet" href="{% static 'css/style.css' %}">

<script>
    $(document).on('submit', '#form-add',function(e){

$.ajax({
  type:'POST',
  url:"{% url 'article:add' %}",
  data:{
      action:'post',
      title:$('#title').val(),
      body:$('#description').val(),
      slug: $("#slug").val(),
      csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
  },
  success:function(json){


    document.getElementById("form-add").reset();
      var slug = json.description;
      var slugtitle = jQuery.trim(slug).split(" ").join("-")

      var test = json.slug;
      var a = test.replaceAll(" ","-");
      $(".container").prepend('<div class="card">'+
        '<div class="card-body">' +
          '<h5 class="card-title">'+json.title+'</h5>'+
          '<p class="card-text">'+slugtitle+'</p>' +
              ' <a href="'+json.slug+'" class="read-more">Read more</a>' +
          '</div>' +
      '</div>'
      )
  },
  error : function(xhr,errmsg,err) {
  console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
}
});
});
</script>
{% endblock meta %}

{% block content %}
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<script src="{% static 'js/scripts.js' %}"></script>

<div class="bg">
  <div class="image">
    <img src="https://serudsindia.org/wp-content/uploads/2020/11/Donate-Money-For-Food-In-India-To-Special-Charity-Programs.png" alt="">
    <div class="text">
      {% if user.is_authenticated %}
      {% if user.role == "Penyalur" %}
        <div class="header">
          <H2> <strong> Halo {{user}}! </strong></H2>
          <br>
        </div>
          <h3> <strong> Tambahkan artikelmu disini! </strong></h3>
          <br>
          <button class="btn btn-warning " id="button-modal" type="submit" data-toggle="modal" data-target="#exampleModal">
            Tambahkan Artikel
          </button>
        
      {% else %}
      <div class="header">
        <H2> <strong> Halo {{user}}! </strong></H2>
        <br>
      </div>
        <h4> <strong> There are genuinely sufficient resources in the world to ensure that no one, nowhere, at no time, should go hungry. </strong> </h4>
        <h4><strong>-Ed Asner-</strong></h4>
      {% endif %}
      {% else %}
      <h4> <strong> There are genuinely sufficient resources in the world to ensure that no one, nowhere, at no time, should go hungry.</strong> </h4>
      <h4><strong>-Ed Asner-</strong></h4>
    {% endif %}      
    </div>
  </div>
</div>


<div class="container">


</div>


<!-- Button trigger modal -->

  
  <!-- Modal -->
  <div class="modal fade modal-xxl" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Buat Artikel Baru</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form method="POST" action="" id= "form-add" >
            {% csrf_token %}
            <div class="form-group">
              <label for="title">Title</label>
              <input type="text" id="title" name="title" placeholder="Masukkan judul" class="form-control" onload="convertToSlug(this.value)" onkeyup="convertToSlug(this.value)" required>
            </div>

            <div class ="form-group">
              <label>Body</label>
              <textarea type="text" rows= "10" id="description" class="form-control" required></textarea>
              
            </div>
            <div class ="form-group">
              <label>Slug URL</label>
              <textarea disabled type="text" id="slug" placeholder="Slug URL" class="form-control" required></textarea>
            </div>
              <input type="submit" class="btn btn-warning btn-sm" name="submit" value="Tambah Artikel">

              </div>
            </div>
          </form> 
        </div>
      
      </div>
    </div>
  </div>
    {% comment %} Tambahkan data di bawah baris ini {% endcomment %}
 

{% endblock content %}