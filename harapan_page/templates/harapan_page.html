{% extends 'base.html' %}
{% block content %}
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"
    integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"
    integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n"
    crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"
    integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn"
    crossorigin="anonymous"></script>
<link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>

<style>
    body {
        font-family: 'Poppins';
    }

    .carousel-caption {
        top: 32%;
    }

    .card,
    h1 {
        margin: 40px;
    }

    .card:hover {
        transform: scale(1.01);
        box-shadow: 0 10px 20px rgba(0, 0, 0, .12), 0 4px 8px rgba(0, 0, 0, .06);
    }

    .carousel-inner {
        height: 400px;
    }
</style>

<div class="d-grid gap-3">
    <div id="myCarousel" class="carousel slide" data-bs-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
            <li data-target="#myCarousel" data-slide-to="1"></li>
            <li data-target="#myCarousel" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://www.london.ac.uk/sites/default/files/styles/max_1300x1300/public/2018-07/nelson-lc-mandela-day.jpg?itok=gPOR6fdZ"
                    class="d-block w-100" alt="Second Slide">
                <div class="carousel-caption d-none d-md-block">
                    <h3>Nelson Mandela</h3>
                    <h6>“Overcoming poverty is not a task of charity, it is an act of justice.”</h6>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://blue.kumparan.com/image/upload/fl_progressive,fl_lossy,c_fill,q_auto:best,w_640/v1557392586/gbsflphemfgavkf4y3il.jpg"
                    class="d-block w-100" alt="First Slide">
                <div class="carousel-caption d-none d-md-block">
                    <h3>Mahatma Gandhi</h3>
                    <p>“Life as if you were to die tomorrow. Learn as if you were life forever.”</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://imgsrv2.voi.id/MAzUUjSgcSefe9BpJVwlzxIJSTT5a-rHIfWkrOS_q5E/auto/1200/675/sm/1/bG9jYWw6Ly8vcHVibGlzaGVycy82MzgvMjAxOTEyMDYxMzM3LW1haW4uY3JvcHBlZF8xNTc1NjE0MjU5LmpwZw.jpg"
                    class="d-block w-100" alt="Third Slide">
                <div class="carousel-caption d-none d-md-block">
                    <h5>Munir Said Thalib</h5>
                    <p>“Setiap orang yang dilahirkan merdeka, memiliki hak dan martabat yang sama.”</p>
                </div>
            </div>
        </div>
        <a class="carousel-control-prev" href="#myCarousel" role="button" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#myCarousel" role="button" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>

    </div>

    <div>
        <h1 class="text-center font-weight-bold">
            Pesan dari Donatur kami...
        </h1>
    </div>

    <div id="harapan-data">

    </div>

    <!-- Card HTML
    <div class="card">
        <div class="card-body">
            <div class="d-flex gap-3 flex-row">
                <h5 class="card-title font-weight-bold">Donatur 1</h5>
                <p class="card-text mx-3"><small class="text-muted">Donatur1@email.com</small></p>
            </div>

            <p class="card-text">"This is a wider card with supporting text below as a natural lead-in to additional
                content. This content is a little bit longer."</p>
            <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
        </div>
    </div>
    -->

    <!-- Button trigger modal -->
    <button type="button" data-toggle="modal" data-target="#modalAddHarapan">
        Add Harapan
    </button>

    <!-- Modal -->
    <div class="modal fade" id="modalAddHarapan" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenter"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <!--Modal Header-->
                <div class="modal-header">
                    <h1 class="modal-title" id="myModalLabel">Tambahkan Harapan Anda!</h1>
                </div>
                <!--Modal Body-->

                <div class="modal-body">
                    <form method="POST" action="" id="add-task-form">
                        {% csrf_token %}
                        <div class="form-outline mb-10">
                            <textarea id='text-handler' type="text" rows="10" class="form-control" name="Hope"
                                placeholder="Your hope" required=""></textarea>
                        </div>
                    </form>
                </div>

                <!--Modal Footer-->
                <div class="modal-footer">
                    <button type="button" data-dismiss="modal">Close</button>
                    <button id="save-harapan" data-dismiss="modal" type="submit">Add Task</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

    $(function () {
        $('#myCarousel').carousel();
    });

    $('.carousel-control-prev').click(function () {
        $('#myCarousel').carousel('prev');
    });

    $('.carousel-control-next').click(function () {
        $('#myCarousel').carousel('next');
    });

    const modal = document.querySelector("modal");
    const AddBtn = document.querySelector(".add-btn");
    // const closeModalBtn = document.querySelector(".btn-close");

    const openModal = function () {
        modal.classList.remove("hidden");
        // openModalBtn.classList.add("hidden");
    };

    const closeModal = function () {
        modal.classList.add("hidden");
        // openModalBtn.classList.remove("hidden");
    };

    // openModalBtn.addEventListener("click", openModal);
    // closeModalBtn.addEventListener("click", closeModal);

    function createHarapan() {
        if ($('#text-handler').val() != "") {           
            $.post({
                url: 'add-harapan/',
                type: 'post',
                data: {
                    'text': $('#text-handler').val(),
                },
                success: harapanShow,
            })
        }
    }
    $('#save-harapan').attr('onclick', `createHarapan()`);

    function harapanShow() {
        $('#harapan-data').empty();
        $.getJSON("./show-json", function (result) {
            for (let i = 0; i < result.length; i++) {
                console.log(result[i].fields.user.name);
                $('#harapan-data').append(
                    `<div class="card">
                        <div class="card-body">
                            <div class="d-flex gap-3 flex-row">
                                <h5 class="card-title font-weight-bold">${result[i].fields.username}</h5>
                                <p class="card-text mx-3"><small class="text-muted">${result[i].fields.email}</small></p>
                            </div>
                            <p class="card-text">${result[i].fields.text}</p>
                            <p class="card-text"><small class="text-muted">${result[i].fields.created_at}</small></p>
                        </div>
                    </div>`
                )
            }
        });
    }

    harapanShow();

</script>

{% endblock content %}